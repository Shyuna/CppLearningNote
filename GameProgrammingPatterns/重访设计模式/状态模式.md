- 操作角色会造成状态变化，如果使用if-else分支来判断状态的变化，很容易产生漏洞。这种具有**复杂分支**和**可变状态**的代码非常易错。
- **有限状态机**可以用来表示有限的状态之间的转移。
- 状态机同时只能处于一个状态，可以使用**枚举**来记录状态。接收到输入时先对状态做分支，分支中依照输入对状态进行转移。
- 实现**状态模式**，使用基类的虚方法为状态定义接口，将先前的switch分支通过虚方法进行实现。状态类中定义角色在当前状态的行为。
- **状态委托**：在角色对象的私有成员变量中添加状态基类的指针，通过修改指针指向的状态对象，修改角色的状态。
- 对于没有其他数据字段的状态，可以使用**静态状态**存储状态对象。所有相同的状态指针都指向同一个实例。
- 对于一些有动态变化的数据字段的状态，需要每次**实例化**新的状态，并且释放旧的状态。实现时状态对象的方法返回新的状态，对旧状态对象的`delete`操作在**角色对象**中执行，避免状态对象删除this指针这种操作。
- 定义状态的**入口行为**，将转换发生后的操作实现在这里，避免在不同旧状态中的重复代码。
- **并发状态机**：不需要交互的多个状态机独立地改变自己的状态。
- **分层状态机**：不同状态之间共享的处理方法可以定义在父状态中，对于一个输入，子状态没有处理时，调用父状态的处理方法。父状态没有处理的输入，由父状态调用父状态的父状态实现。实现了分层的结构。
- **下推自动机**：将新状态压入状态栈中，并且移动状态指针指向新状态。可以存储旧的状态，推出新状态就可以回到旧的状态，实现了状态的记忆。
